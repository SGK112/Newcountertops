<!-- Calculators Page -->
<div class="calculators-page">
    <!-- Hero Section -->
    <section class="page-hero">
        <div class="container">
            <div class="row justify-content-center text-center">
                <div class="col-12 col-lg-8">
                    <h1>Countertop Cost Calculator</h1>
                    <p class="lead">Get an instant estimate for your countertop project based on your location, material choice, and project size.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Calculator Section -->
    <section class="calculator-section">
        <div class="container">
            <div class="row justify-content-center">
                <div class="col-12 col-lg-8">
                    <div class="calculator-card">
                        <form id="costCalculator" class="cost-calculator">
                            
                            <!-- Step 1: Location -->
                            <div class="calculator-step">
                                <h3>1. Your Location</h3>
                                <p>Pricing varies by region due to labor costs and material availability.</p>
                                <div class="form-group">
                                    <label for="zipCode">ZIP Code</label>
                                    <input type="text" id="zipCode" name="zipCode" class="form-control" placeholder="Enter your ZIP code" required>
                                </div>
                            </div>

                            <!-- Step 2: Material Selection -->
                            <div class="calculator-step">
                                <h3>2. Material Type</h3>
                                <div class="material-options">
                                    <div class="material-option" data-value="granite" data-base-cost="55">
                                        <div class="material-image">
                                            <div class="material-sample granite-sample"></div>
                                        </div>
                                        <h4>Granite</h4>
                                        <p>Natural stone, durable</p>
                                        <div class="price-range">$50-80/sq ft</div>
                                    </div>
                                    
                                    <div class="material-option" data-value="quartz" data-base-cost="70">
                                        <div class="material-image">
                                            <div class="material-sample quartz-sample"></div>
                                        </div>
                                        <h4>Quartz</h4>
                                        <p>Engineered, low maintenance</p>
                                        <div class="price-range">$60-90/sq ft</div>
                                    </div>
                                    
                                    <div class="material-option" data-value="marble" data-base-cost="85">
                                        <div class="material-image">
                                            <div class="material-sample marble-sample"></div>
                                        </div>
                                        <h4>Marble</h4>
                                        <p>Luxury natural stone</p>
                                        <div class="price-range">$70-120/sq ft</div>
                                    </div>
                                    
                                    <div class="material-option" data-value="quartzite" data-base-cost="75">
                                        <div class="material-image">
                                            <div class="material-sample quartzite-sample"></div>
                                        </div>
                                        <h4>Quartzite</h4>
                                        <p>Natural, very durable</p>
                                        <div class="price-range">$65-100/sq ft</div>
                                    </div>
                                    
                                    <div class="material-option" data-value="butcher-block" data-base-cost="40">
                                        <div class="material-image">
                                            <div class="material-sample wood-sample"></div>
                                        </div>
                                        <h4>Butcher Block</h4>
                                        <p>Warm, renewable</p>
                                        <div class="price-range">$30-60/sq ft</div>
                                    </div>
                                </div>
                                <input type="hidden" name="material" id="selectedMaterial">
                            </div>

                            <!-- Step 3: Project Details -->
                            <div class="calculator-step">
                                <h3>3. Project Details</h3>
                                <div class="row">
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <label for="length">Length (feet)</label>
                                            <input type="number" id="length" name="length" class="form-control" min="1" max="50" step="0.5" placeholder="10">
                                        </div>
                                    </div>
                                    <div class="col-md-6">
                                        <div class="form-group">
                                            <label for="width">Average Width (feet)</label>
                                            <input type="number" id="width" name="width" class="form-control" min="1" max="10" step="0.25" placeholder="2.5">
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="calculated-area">
                                    <span>Estimated Square Footage: <strong id="totalSquareFeet">0</strong> sq ft</span>
                                </div>
                            </div>

                            <!-- Step 4: Additional Options -->
                            <div class="calculator-step">
                                <h3>4. Additional Options</h3>
                                <div class="additional-options">
                                    <div class="option-group">
                                        <label class="option-checkbox">
                                            <input type="checkbox" name="edgeWork" value="200">
                                            <span class="checkmark"></span>
                                            Premium Edge Work (+$8-15/linear ft)
                                        </label>
                                    </div>
                                    <div class="option-group">
                                        <label class="option-checkbox">
                                            <input type="checkbox" name="backsplash" value="150">
                                            <span class="checkmark"></span>
                                            Matching Backsplash (+$15-25/sq ft)
                                        </label>
                                    </div>
                                    <div class="option-group">
                                        <label class="option-checkbox">
                                            <input type="checkbox" name="undermount" value="100">
                                            <span class="checkmark"></span>
                                            Undermount Sink Cutout (+$100-200)
                                        </label>
                                    </div>
                                </div>
                            </div>

                            <button type="button" class="btn btn-primary btn-lg w-100" onclick="calculateCost()">
                                Calculate My Estimate
                            </button>
                        </form>

                        <!-- Results Section -->
                        <div class="results-section" id="resultsSection" style="display: none;">
                            <div class="estimate-result">
                                <h3>Your Estimate</h3>
                                <div class="price-breakdown">
                                    <div class="price-item">
                                        <span>Material Cost:</span>
                                        <span id="materialCost">$0</span>
                                    </div>
                                    <div class="price-item">
                                        <span>Installation:</span>
                                        <span id="installationCost">$0</span>
                                    </div>
                                    <div class="price-item additional" id="additionalCosts" style="display: none;">
                                        <span>Additional Options:</span>
                                        <span id="additionalCost">$0</span>
                                    </div>
                                    <div class="price-total">
                                        <span>Total Estimate:</span>
                                        <span id="totalCost">$0</span>
                                    </div>
                                </div>
                                
                                <div class="estimate-disclaimer">
                                    <p><strong>Note:</strong> This is an estimated cost based on average pricing in your area. Actual costs may vary based on specific materials, complexity, and contractor rates.</p>
                                </div>
                                
                                <div class="estimate-actions">
                                    <a href="/get-quote" class="btn btn-primary btn-lg">Get Detailed Quotes</a>
                                    <button type="button" class="btn btn-outline btn-lg" onclick="resetCalculator()">Calculate Again</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- How It Works -->
    <section class="how-it-works-section">
        <div class="container">
            <div class="row justify-content-center text-center">
                <div class="col-12 col-lg-8">
                    <h2>How Our Calculator Works</h2>
                    <p class="lead">Get accurate estimates based on real market data</p>
                </div>
            </div>
            <div class="row">
                <div class="col-12 col-md-4">
                    <div class="how-it-works-step">
                        <div class="step-icon">📍</div>
                        <h3>Location-Based</h3>
                        <p>Pricing adjusts based on your ZIP code to reflect local labor costs and material availability.</p>
                    </div>
                </div>
                <div class="col-12 col-md-4">
                    <div class="how-it-works-step">
                        <div class="step-icon">📊</div>
                        <h3>Real Market Data</h3>
                        <p>Our estimates are based on current market prices from verified contractors and suppliers.</p>
                    </div>
                </div>
                <div class="col-12 col-md-4">
                    <div class="how-it-works-step">
                        <div class="step-icon">🎯</div>
                        <h3>Comprehensive</h3>
                        <p>Includes material, installation, and optional upgrades for a complete project estimate.</p>
                    </div>
                </div>
            </div>
        </div>
    </section>
</div>

<style>
/* Calculator Page Styles */
.calculators-page {
    min-height: 100vh;
}

.page-hero {
    background: linear-gradient(135deg, var(--primary-light), var(--primary-color));
    color: white;
    padding: 80px 0;
    text-align: center;
}

.page-hero h1 {
    font-size: 3rem;
    font-weight: 700;
    margin-bottom: 1rem;
}

.calculator-section {
    padding: 80px 0;
    background: var(--lighter-gray);
}

.calculator-card {
    background: var(--card-background);
    border-radius: 16px;
    padding: 40px;
    box-shadow: 0 10px 30px var(--shadow-medium);
}

.calculator-step {
    margin-bottom: 40px;
    padding-bottom: 30px;
    border-bottom: 1px solid var(--gray-200);
}

.calculator-step:last-of-type {
    border-bottom: none;
}

.calculator-step h3 {
    color: var(--primary-color);
    margin-bottom: 8px;
    font-size: 1.5rem;
}

.calculator-step p {
    color: var(--gray-500);
    margin-bottom: 24px;
}

.material-options {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 20px;
    margin-bottom: 20px;
}

.material-option {
    border: 2px solid var(--gray-200);
    border-radius: 12px;
    padding: 20px;
    text-align: center;
    cursor: pointer;
    transition: all 0.3s ease;
}

.material-option:hover {
    border-color: var(--primary-light);
    transform: translateY(-2px);
}

.material-option.active {
    border-color: var(--primary-light);
    background: var(--blue-50);
}

.material-image {
    width: 80px;
    height: 80px;
    margin: 0 auto 16px;
    border-radius: 8px;
    overflow: hidden;
}

.material-sample {
    width: 100%;
    height: 100%;
    background-size: cover;
    background-position: center;
}

.granite-sample { background: linear-gradient(45deg, var(--gray-600), var(--gray-700)); }
.quartz-sample { background: linear-gradient(45deg, var(--gray-100), var(--gray-200)); }
.marble-sample { background: linear-gradient(45deg, var(--white), var(--gray-100)); }
.quartzite-sample { background: linear-gradient(45deg, var(--gray-200), var(--gray-300)); }
.wood-sample { background: linear-gradient(45deg, var(--secondary-color), var(--secondary-dark)); }

.material-option h4 {
    margin-bottom: 8px;
    color: var(--primary-color);
}

.material-option p {
    margin-bottom: 8px;
    color: var(--text-secondary);
    font-size: 0.9rem;
}

.price-range {
    font-weight: 600;
    color: var(--success-color);
}

.calculated-area {
    background: var(--info-background);
    padding: 16px;
    border-radius: 8px;
    text-align: center;
    font-size: 1.1rem;
}

.additional-options {
    display: grid;
    gap: 16px;
}

.option-checkbox {
    display: flex;
    align-items: center;
    cursor: pointer;
    padding: 16px;
    border: 1px solid var(--border-light);
    border-radius: 8px;
    transition: all 0.3s ease;
}

.option-checkbox:hover {
    background: var(--surface-color);
}

.option-checkbox input[type="checkbox"] {
    margin-right: 12px;
}

.results-section {
    margin-top: 40px;
    padding-top: 40px;
    border-top: 2px solid var(--border-light);
}

.estimate-result {
    text-align: center;
}

.price-breakdown {
    background: #f8fafc;
    border-radius: 12px;
    padding: 24px;
    margin: 24px 0;
}

.price-item {
    display: flex;
    justify-content: space-between;
    margin-bottom: 12px;
    font-size: 1.1rem;
}

.price-total {
    display: flex;
    justify-content: space-between;
    padding-top: 16px;
    border-top: 2px solid var(--border-light);
    font-size: 1.3rem;
    font-weight: 700;
    color: var(--primary-color);
}

.estimate-disclaimer {
    background: var(--warning-background);
    border: 1px solid var(--accent-yellow);
    border-radius: 8px;
    padding: 16px;
    margin: 24px 0;
    font-size: 0.9rem;
}

.estimate-actions {
    display: flex;
    gap: 16px;
    justify-content: center;
    flex-wrap: wrap;
}

.how-it-works-section {
    padding: 80px 0;
    text-align: center;
}

.how-it-works-step {
    padding: 32px 16px;
}

.step-icon {
    font-size: 3rem;
    margin-bottom: 16px;
}

.how-it-works-step h3 {
    color: var(--primary-color);
    margin-bottom: 16px;
}

/* Mobile Responsiveness */
@media (max-width: 768px) {
    .page-hero {
        padding: 60px 0;
    }
    
    .page-hero h1 {
        font-size: 2rem;
    }
    
    .calculator-card {
        padding: 24px;
    }
    
    .material-options {
        grid-template-columns: 1fr;
    }
    
    .estimate-actions {
        flex-direction: column;
    }
    
    .estimate-actions .btn {
        width: 100%;
    }
}
</style>

<script>
// Regional pricing multipliers based on ZIP code prefixes
const regionalMultipliers = {
    '100': 1.4, // NYC area
    '101': 1.4, '102': 1.4, '103': 1.4, '104': 1.4, '105': 1.4,
    '200': 1.3, // DC area
    '201': 1.3, '202': 1.3, '203': 1.3, '204': 1.3, '205': 1.3,
    '900': 1.3, // CA major cities
    '901': 1.3, '902': 1.3, '903': 1.3, '904': 1.3, '905': 1.3,
    '940': 1.4, '941': 1.4, // San Francisco Bay Area
    '980': 1.3, '981': 1.3, // Seattle area
    '600': 1.2, '601': 1.2, // Chicago area
    '770': 1.1, '771': 1.1, // Atlanta area
    '750': 1.1, '751': 1.1, // Dallas area
    '330': 1.1, '331': 1.1, // Miami area
    'default': 1.0 // Base pricing for other areas
};

function getRegionalMultiplier(zipCode) {
    if (!zipCode) return 1.0;
    const prefix3 = zipCode.substring(0, 3);
    const prefix2 = zipCode.substring(0, 2);
    
    return regionalMultipliers[prefix3] || regionalMultipliers[prefix2] || regionalMultipliers['default'];
}

// Material selection handler
document.addEventListener('click', function(e) {
    const materialOption = e.target.closest('.material-option');
    if (!materialOption) return;
    
    // Remove active class from all options
    document.querySelectorAll('.material-option').forEach(option => {
        option.classList.remove('active');
    });
    
    // Add active class to clicked option
    materialOption.classList.add('active');
    
    // Store selected material
    document.getElementById('selectedMaterial').value = materialOption.dataset.value;
    
    // Update calculations if other values are present
    updateCalculations();
});

// Input change handlers
document.getElementById('length').addEventListener('input', updateCalculations);
document.getElementById('width').addEventListener('input', updateCalculations);
document.getElementById('zipCode').addEventListener('input', updateCalculations);

function updateCalculations() {
    const length = parseFloat(document.getElementById('length').value) || 0;
    const width = parseFloat(document.getElementById('width').value) || 0;
    const squareFeet = length * width;
    
    document.getElementById('totalSquareFeet').textContent = squareFeet.toFixed(1);
}

function calculateCost() {
    const material = document.getElementById('selectedMaterial').value;
    const length = parseFloat(document.getElementById('length').value);
    const width = parseFloat(document.getElementById('width').value);
    const zipCode = document.getElementById('zipCode').value;
    
    // Validation
    if (!material) {
        alert('Please select a material type');
        return;
    }
    if (!length || !width) {
        alert('Please enter length and width');
        return;
    }
    if (!zipCode) {
        alert('Please enter your ZIP code');
        return;
    }
    
    const squareFeet = length * width;
    const selectedMaterialOption = document.querySelector('.material-option.active');
    const baseCost = parseFloat(selectedMaterialOption.dataset.baseCost);
    const regionalMultiplier = getRegionalMultiplier(zipCode);
    
    // Calculate material cost
    const adjustedMaterialCost = baseCost * regionalMultiplier;
    const materialCost = squareFeet * adjustedMaterialCost;
    
    // Calculate installation cost (typically 30-50% of material cost)
    const installationCost = materialCost * 0.4;
    
    // Calculate additional options
    let additionalCost = 0;
    const checkboxes = document.querySelectorAll('input[type="checkbox"]:checked');
    checkboxes.forEach(checkbox => {
        additionalCost += parseFloat(checkbox.value);
    });
    
    // Display results
    document.getElementById('materialCost').textContent = `$${materialCost.toLocaleString()}`;
    document.getElementById('installationCost').textContent = `$${installationCost.toLocaleString()}`;
    document.getElementById('additionalCost').textContent = `$${additionalCost.toLocaleString()}`;
    document.getElementById('totalCost').textContent = `$${(materialCost + installationCost + additionalCost).toLocaleString()}`;
    
    // Show/hide additional costs
    const additionalCostsElement = document.getElementById('additionalCosts');
    if (additionalCost > 0) {
        additionalCostsElement.style.display = 'flex';
    } else {
        additionalCostsElement.style.display = 'none';
    }
    
    // Show results section
    document.getElementById('resultsSection').style.display = 'block';
    document.getElementById('resultsSection').scrollIntoView({ behavior: 'smooth' });
}

function resetCalculator() {
    // Reset form
    document.getElementById('costCalculator').reset();
    
    // Clear selections
    document.querySelectorAll('.material-option').forEach(option => {
        option.classList.remove('active');
    });
    
    // Hide results
    document.getElementById('resultsSection').style.display = 'none';
    
    // Reset square footage display
    document.getElementById('totalSquareFeet').textContent = '0';
    
    // Scroll to top
    window.scrollTo({ top: 0, behavior: 'smooth' });
}
</script>
